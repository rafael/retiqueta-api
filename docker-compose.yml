api:
  build: .
  command: "config/container/start-server-dev.sh -bash"
  volumes:
    - .:/app
    - ./config/container/dev/ssl:/etc/secrets
  ports:
    - "3000:3000"
  links:
    - db
    - kong
    - redis
    - elasticsearch
  environment:
    S3_BUCKET_NAME: "retiqueta-dev-images"
    AWS_ACCESS_KEY_ID: "AKIAJPD6UFMMPDH2LNZA"
    AWS_SECRET_ACCESS_KEY: "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"
    MYSQL_ROOT_PASSWORD: 123456
    REDIS_SERVICE_HOST: "redis"
    REDIS_SERVICE_PORT: "6379"
    SMTP_USER_NAME: dextrin.diorman@gmail.com
    SMTP_PASSWORD: u7uu24nmtB47K9YigTyThg
    SMTP_PASSWORD: u7uu24nmtB47K9YigTyThg
    ML_VE_PUBLIC_KEY: TEST-f4c0a8de-a40c-46c2-90f9-202e66994dd3
    ML_VE_ACCESS_TOKEN: TEST-7996492241102187-020901-2125bf21d3eda6d5c1150a3ae949e743__LD_LB__-203200861
    SECRET_PATHS: "/etc/secrets"
    FB_CLIENT_ID: 218614578499396
    FB_CLIENT_SECRET: 27c75c1fdd4a408aaf923e2230e5150b
    KONG_ADMIN_SERVICE_HOST: kong
    KONG_ADMIN_SERVICE_PORT: 8001
    UPSTREAM_SERVICE_HOST:
worker:
  build: .
  command: "config/container/start-workers.sh -bash"
  volumes:
    - .:/app
  links:
    - elasticsearch
    - db
    - redis
    - kong
  environment:
    S3_BUCKET_NAME: "retiqueta-dev-images"
    AWS_ACCESS_KEY_ID: "AKIAJPD6UFMMPDH2LNZA"
    AWS_SECRET_ACCESS_KEY: "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"
    MYSQL_ROOT_PASSWORD: 123456
    REDIS_SERVICE_HOST: "redis"
    REDIS_SERVICE_PORT: "6379"
    SMTP_USER_NAME: dextrin.diorman@gmail.com
    SMTP_PASSWORD: u7uu24nmtB47K9YigTyThg
    SECRET_PATHS: "/etc/secrets"
redis:
 image: library/redis:2.6.17
 ports:
   - "6379:6379"
db:
  image: library/mysql:5.6.22
  ports:
    - "3306:3306"
  environment:
    MYSQL_ROOT_PASSWORD: 123456
kong:
  image: rafael/kong:0.5.2
  ports:
    - "80:8000"
    - "443:8443"
    - "8001:8001"
  links:
    - cassandra
  volumes:
    - ./config/container/dev/kong:/etc/kong
cassandra:
  image: mashape/cassandra
  ports:
    - "9042:9042"
elasticsearch:
  image: library/elasticsearch:1.7.1
  ports:
    - "9200:9200"
    - "9300:9300"
